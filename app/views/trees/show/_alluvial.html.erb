<script type="text/javascript">
// Example data:
// var data = [
//       ['BI.1.01', 'CP.1.01', 1, 'BI.1.01 applies to CP.1.01'],
//       ['BI.1.01', 'CP.1.05', 1, 'BI.1.01 applies to CP.1.05'],
//       ['CH.1.01', null, 1, 'CH.1.01 akin to BI.1.01'],
//       ['PH.1.01', 'BI.1.01', 1, 'BI.1.01 depends on PH.1.01']
//     ];

  Highcharts.chart('js-alluvial-container', {
    title: {
      text: '<%= chart_name %>'
    },
    accessibility: {
      point: {
        valueDescriptionFormat: '{index}. {point.from} to {point.to}, {point.tooltip}.'
      }
    },
    series: [{
      keys: ['from', 'to', 'weight', 'tooltip'],
      data: JSON.parse('<%= data.to_json.html_safe %>'),
      type: 'sankey',
      name: '<%= chart_name %>',
      tooltip: {
              headerFormat: '',
              pointFormat: '<b>{point.tooltip}</b>',
              nodeFormatter: function() {
                  var result = '';

                  Highcharts.each(this.linksFrom, function(el) {
                      result += (el.tooltip && result ? ',' : '') + el.tooltip;
                  });

                  return result;
              }
          },
    }],
  });

</script>